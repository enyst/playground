I'd like you to perform a thorough code review. Please:

1. Review the code for potential bugs, security issues, and performance problems
2. Check for code style and best practices
3. Suggest improvements and optimizations
4. Identify any missing error handling or edge cases
5. Provide specific recommendations with code examples

Please be thorough but constructive in your feedback.
